<!DOCTYPE html>
<html lang="en"><head>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-html/tabby.min.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/light-border.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-2f5df379a58b258e96c21c0638c20c03.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.6.42">

  <meta name="author" content="Jason Locklin, Data Science Lead, Toronto Catholic District School Board">
  <meta name="dcterms.date" content="2025-07-17">
  <title>Surveydown – Technical Preview of a Self-Hosted Survey Platform: SurveyDown</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="site_libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="site_libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; font-weight: bold; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="site_libs/revealjs/dist/theme/quarto-8f3eebe07241f08526c91a7e9cbef8fd.css">
  <link rel="stylesheet" href="styles.css">
  <link href="site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="site_libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="site_libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="site_libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">Technical Preview of a Self-Hosted Survey Platform: SurveyDown</h1>
  <p class="subtitle">An R/Shiny application for delivering surveys</p>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Jason Locklin, Data Science Lead, Toronto Catholic District School Board 
</div>
</div>
</div>

  <p class="date">2025-07-17</p>
</section>
<section id="welcome" class="slide level2">
<h2>Welcome</h2>
<p>About me</p>
<ul>
<li><strong>Jason Locklin</strong></li>
<li>Data Science Lead</li>
<li>Toronto Catholic District School Board</li>
</ul>
<aside class="notes">
<p>Good morning, everyone. My name is Jason Locklin, and I’m the Data Science Lead at the Toronto Catholic District School Board. I’m excited to be here today to talk about a project that I believe has significant potential for all of us in Ontario’s education sector. My goal is to give you a technical preview of a self-hosted survey platform called <code>surveydown</code>.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="section-1-what-is-surveydown" class="slide level2">
<h2>Section 1: What is <code>surveydown</code>?</h2>
<p>Surveydown is an open-source platform for programmable and reproducible surveys using <code>R</code>, <code>Quarto</code>, <code>Shiny</code>, and a <code>PostgreSQL</code> database.</p>
<ul>
<li>Helveston J, Hu P, Bunea B (2024). <em>surveydown: Markdown-Based Surveys Using Quarto And Shiny</em>. R package, <a href="https://surveydown.org/" class="uri">https://surveydown.org/</a>.</li>
</ul>
</section>
<section id="the-foundation-what-is-quarto" class="slide level2">
<h2>The Foundation: What is Quarto?</h2>
<p>Quarto is a program that produces documents that can include code from R and other languages. This is a Quarto document!</p>
<aside class="notes">
<p>Note that the syntax for Quarto is only slightly changed from Rmarkdown and it’s easy to convert documents. Quarto can produce all sorts of document types, and can be used for general writing as well as literate programming of analyses.</p>
<p>You may have used <code>knitr</code> in R to produce RMarkdown notebooks. Quarto is a stand-alone replacement that can run independently of R.</p>
<p>These documents, however, are not interactive on their own.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="the-foundation-what-is-shiny" class="slide level2">
<h2>The Foundation: What is Shiny?</h2>
<p>Shiny is an R package that builds interactive web applications <em>directly from R</em>.</p>
<ul>
<li>You write R code.</li>
<li>Shiny turns it into an interactive website with buttons, sliders, plots, and more.</li>
<li>No need to learn HTML, CSS, or JavaScript.</li>
<li>It’s the engine that makes <code>surveydown</code> interactive.</li>
</ul>
<aside class="notes">
<p>Before we can talk about <code>surveydown</code>, we need to understand its engine: Shiny. For those who haven’t used it, Shiny is a powerful package from Posit that allows us to build interactive web applications without leaving the R environment we’re comfortable with. It’s what takes our data analysis and turns it into a tool that others can use, and it’s the magic that will power our live surveys.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="the-bridge-what-is-surveydown" class="slide level2">
<h2>The Bridge: What is <code>surveydown</code>?</h2>
<p><code>surveydown</code> is an R package that hosts surveys.</p>
<ul>
<li>You write a Quarto document with questions</li>
<li>Shiny runs the application for interactivity on the web</li>
<li>Data is collected in a database</li>
</ul>
<aside class="notes">
<p>So, what is <code>surveydown</code>? It’s the specialized tool that connects the document-writing world of Quarto with the interactive world of Shiny. You write your survey questions in a simple document, and <code>surveydown</code> does the heavy lifting of converting that into a full-fledged Shiny application and setting up the connection to a database to store the responses.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="surveydown-project-goals" class="slide level2">
<h2><code>surveydown</code>: Project Goals</h2>
<p>The <code>surveydown</code> project, according to its developers, has clear goals:</p>
<ul>
<li><strong>Ease of Use:</strong></li>
<li><strong>Performance:</strong></li>
<li><strong>Flexibility:</strong></li>
<li><strong>Open Source:</strong></li>
</ul>
<aside class="notes">
<p>Based on their blog and documentation, the authors of <code>surveydown</code> have a clear vision. They want to create a tool that is not only easy to use for R practitioners but also performant enough for real-world data collection. They emphasize flexibility, showing off advanced use cases, and most importantly, it’s a completely open-source project, which aligns perfectly with the needs of the public sector.</p>
<ul>
<li><strong>Ease of Use:</strong> Make survey creation in R simple and intuitive.</li>
<li><strong>Performance:</strong> Ensure surveys are fast and can handle many concurrent users (with the right hosting).</li>
<li><strong>Flexibility:</strong> Allow for everything from simple questionnaires to complex, dynamic designs like conjoint analysis.</li>
<li><strong>Open Source:</strong> Provide a free, transparent, and community-driven alternative to proprietary platforms that can be run on your own infrastructure.</li>
</ul>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="surveydown-development-status" class="slide level2">
<h2><code>surveydown</code>: Development Status</h2>
<ul>
<li>The package should be considered alpha software, with frequent updates.</li>
<li>The official documentation focuses on free cloud deployment (e.g., shinyapps.io, Supabase).</li>
<li><strong>This is where my project comes in:</strong> to provide a straightforward path to <em>self-hosting</em>.</li>
</ul>
<aside class="notes">
<p><code>surveydown</code> is a young but rapidly maturing project. It’s being actively developed, with the authors recently releasing a major update that improved the underlying architecture. While their excellent documentation primarily focuses on using cloud services for hosting, my project aims to fill a gap by providing a clear, reproducible pattern for self-hosting on our own infrastructure.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="self-host" class="slide level2">
<h2>Self-Host?</h2>
<p>For school boards, this isn’t just a technical decision—it’s a strategic one.</p>
<ul>
<li><strong>Data Governance &amp; Sovereignty:</strong></li>
<li><strong>Cost Savings:</strong></li>
<li><strong>Customization &amp; Collaboration:</strong></li>
<li><strong>No Vendor Lock-in:</strong></li>
</ul>
<aside class="notes">
<p>So, why go to the trouble of self-hosting? The reasons are compelling for us in school boards. It’s about data sovereignty and security—keeping our sensitive data on our own servers. It’s about significant cost savings over commercial platforms. And it’s about control—the freedom to customize our tools and avoid being locked into a specific vendor’s ecosystem.</p>
<ul>
<li><strong>Data Governance &amp; Sovereignty:</strong> Keep student and staff data on your own infrastructure, under your control.</li>
<li><strong>Cost Savings:</strong> Avoid annual subscription fees for survey platforms.</li>
<li><strong>Customization &amp; Collaboration:</strong> Full control over the survey’s functionality and appearance as shareable R source.</li>
<li><strong>No Vendor Lock-in:</strong> Freedom to adapt and evolve your tools as your needs change.</li>
</ul>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="section-2-creating-a-survey-in-surveydown" class="slide level2">
<h2>Section 2: Creating a Survey in <code>surveydown</code></h2>
</section>
<section id="the-authoring-workflow" class="slide level2">
<h2>The Authoring Workflow</h2>
<p>Creating a survey follows a simple, logical path from a text file to a live application.</p>
<ol type="1">
<li>Start with a <code>survey.qmd</code> file<br>
</li>
<li>Write Markdown for text<br>
</li>
<li>Add R code chunks for any calculations</li>
<li>Use <code>sd_question()</code> to define questions<br>
</li>
<li>Set type, id, label, options…<br>
</li>
<li>Render with Quarto and <code>surveydown</code><br>
</li>
<li>Result: Live Shiny Surveydown app</li>
</ol>
<aside class="notes">
<p>Let’s walk through how you actually build a survey. This diagram shows the workflow. It all starts with a single Quarto file. In this file, you’ll write standard Markdown for your text and instructions, and then you’ll add R code chunks where you define your questions using the <code>sd_question</code> function. Once you’re done, <code>surveydown</code> processes this file and automatically generates a fully functional Shiny web application.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="the-survey.qmd-file" class="slide level2">
<h2>The <code>survey.qmd</code> File</h2>
<p>A <code>surveydown</code> survey starts as a simple Quarto (<code>.qmd</code>) file.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode numberSource markdown number-lines code-with-copy"><code class="sourceCode markdown"><span id="cb1-1"><a></a><span class="co">---</span></span>
<span id="cb1-2"><a></a><span class="an">title:</span><span class="co"> "My First Survey"</span></span>
<span id="cb1-3"><a></a><span class="co">---</span></span>
<span id="cb1-4"><a></a></span>
<span id="cb1-5"><a></a>Welcome to my survey!</span>
<span id="cb1-6"><a></a></span>
<span id="cb1-7"><a></a><span class="sc">\`</span>``{r}</span>
<span id="cb1-8"><a></a><span class="fu"># Questions go here in R code chunks (no '\')</span></span>
<span id="cb1-9"><a></a><span class="sc">\`</span>``</span>
<span id="cb1-10"><a></a></span>
<span id="cb1-11"><a></a>Thank you for participating.</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<aside class="notes">
<p>This is what that <code>survey.qmd</code> file looks like in its simplest form. It has a YAML header for the title, some markdown text for the introduction, a placeholder for our R code chunks, and a concluding message. It’s a plain text file, which is great for version control with tools like Git.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="the-core-sd_question" class="slide level2">
<h2>The Core: <code>sd_question()</code></h2>
<p>Every individual survey item is created with the <code>sd_question()</code> function.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a></a><span class="co"># A simple multiple-choice question</span></span>
<span id="cb2-2"><a></a><span class="fu">sd_question</span>(</span>
<span id="cb2-3"><a></a>  <span class="at">type  =</span> <span class="st">'mc'</span>,</span>
<span id="cb2-4"><a></a>  <span class="at">id    =</span> <span class="st">'fav_fruit'</span>,</span>
<span id="cb2-5"><a></a>  <span class="at">label =</span> <span class="st">'What is your favorite fruit?'</span>,</span>
<span id="cb2-6"><a></a>  <span class="at">option =</span> <span class="fu">c</span>(<span class="st">'Apple'</span>, <span class="st">'Banana'</span>, <span class="st">'Orange'</span>)</span>
<span id="cb2-7"><a></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<aside class="notes">
<p>The workhorse of <code>surveydown</code> is the <code>sd_question()</code> function. This single function is used to create all types of questions. At a minimum, you need to provide the <code>type</code> of question, a unique <code>id</code> for that question so you can identify it in the data later, and the <code>label</code>, which is the question text the user sees.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="a-variety-of-question-types" class="slide level2">
<h2>A Variety of Question Types</h2>
<p><code>surveydown</code> supports many common question types.</p>
<p><strong>Text Input:</strong> <code>sd_question(type = 'text', ...)</code></p>
<p><strong>Numeric Input:</strong> <code>sd_question(type = 'numeric', ...)</code></p>
<p><strong>Likert Scale:</strong> <code>sd_question(type = 'likert', ...)</code></p>
<p><strong>And more:</strong> <em><a href="https://surveydown.org/docs/question-types">surveydown.org/docs/question-types</a></em></p>
<aside class="notes">
<p><code>surveydown</code> supports a wide range of inputs. You can create free-form text questions, number inputs, and Likert scales, which are very common in our line of work. The structure is always the same: <code>sd_question()</code> with the appropriate type.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="survey-features" class="slide level2">
<h2>Survey Features</h2>
<p><code>surveydown</code> already supports many required features of a powerful survey platform:</p>
<ul>
<li>Conditional display logic</li>
<li>Custom questions and custom formatting</li>
<li>Translations (limited)</li>
<li>Data access for displaying “past responses”</li>
<li>Reactivity and Randomization</li>
<li>External redirection</li>
<li>An administrative “dashboard” (very limited)</li>
</ul>
<aside class="notes">
<p>Despite being very new, it is already possible to do many of the complex features of legacy survey platforms, though many are only partially implemented so far.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="follow-the-surveydown-project-for-updates" class="slide level2">
<h2>Follow the <code>surveydown</code> project for updates</h2>
<ul>
<li><a href="https://surveydown.org/blog/">https://surveydown.org/blog/</a> (which is a <code>quarto</code> document!)</li>
</ul>
</section>
<section id="section-3-my-approach-to-self-hosting-surveydown" class="slide level2">
<h2>Section 3: My Approach to Self-hosting <code>surveydown</code></h2>
</section>
<section id="the-goal-make-self-hosting-simple" class="slide level2">
<h2>The Goal: Make Self-Hosting Simple</h2>
<p>The main challenge with self-hosting is complexity. My project aims to solve this by providing a simple, repeatable template using <strong>containers</strong>.</p>
</section>
<section id="why-use-containers-docker" class="slide level2">
<h2>Why Use Containers (Docker)?</h2>
<p>Think of a container like a standardized shipping container for software.</p>
<ul>
<li>It packages an application and <strong>all its dependencies</strong> (R, packages, system libraries) into one neat box.</li>
<li>This “box” runs the same way everywhere: on your laptop, on a server in your board’s data center, or in the cloud.</li>
</ul>
<p>This makes deployment predictable and easy.</p>
<aside class="notes">
<p>So, let’s talk about the self-hosting project. The biggest barrier is often the technical complexity of setting up servers. My project uses a technology called Docker to simplify this. The best analogy for Docker is a shipping container. It bundles up an application, like our Shiny Server, with all its dependencies—the correct version of R, all the R packages, everything—into a single, isolated box. This box will run identically wherever you put it, which makes deployment incredibly reliable.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="a-starting-point-for-your-board" class="slide level2">
<h2>A Starting Point for Your Board</h2>
<p>This project is <strong>not</strong> a final product. It’s a demonstration and a template.</p>
<ol type="1">
<li><strong>For You:</strong> Easily and cheaply demonstrate a fully working on-premise <code>surveydown</code> instance to your colleagues and leadership.</li>
<li><strong>For Your IT Department:</strong> A clear, working template they can adapt for production. It shows exactly what components are needed and how they connect.</li>
</ol>
<aside class="notes">
<p>It’s crucial to understand what this project is and isn’t. It’s not a rigid, one-size-fits-all solution. Instead, it’s a starting point. For us, the researchers and data users, it’s a cheap and easy way to demonstrate the power of a self-hosted <code>surveydown</code>. For our IT departments, it’s a working template that takes the guesswork out of deployment. They can see exactly what’s needed and adapt it to fit into their existing infrastructure and security policies.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="designed-for-flexibility" class="slide level2">
<h2>Designed for Flexibility</h2>
<p>The components in this project are “pluggable.” You can swap them out to match your board’s infrastructure.</p>
<ol type="1">
<li>Included <code>PostgreSQL</code> database pre-configured to work with <code>surveydown</code></li>
<li>Included web server with TLS (<code>https://your_address.com</code>) encryption and a download data url.</li>
<li>A Dockerfile that builds a full-featured shiny server.</li>
</ol>
<aside class="notes">
<p>The <strong>Shiny Server container</strong> is the most valuable piece. You can use it to host most <em>any</em> Shiny app, not just <code>surveydown</code>.</p>
<p>This template is designed to be flexible. The core component is the Shiny Server container. This is the most valuable part of the package. The other parts—the Caddy web server and the PostgreSQL database—are included for convenience to make a complete, working demo. However, your IT department can easily swap these out. They can use their existing enterprise web server and connect the Shiny Server to a central database. The Shiny container itself is a reusable asset for hosting any Shiny application your team develops.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="additional-details" class="slide level2">
<h2>Additional details</h2>
<p>The shiny server container also:</p>
<ul>
<li>Is preconfigured to host the <code>surveydown</code> templates at <code>/templates</code> for testing</li>
<li>Can be configured to download and host any survey from github at <code>/survey</code></li>
<li>Periodically saves the data in a password protected location <code>/data-export</code> that can be read directly with R.</li>
</ul>
</section>
<section id="minimal-steps-to-get-started" class="slide level2">
<h2>Minimal steps to get started</h2>
<p>Three steps to a running survey platform:</p>
<ol type="1">
<li><strong>Set up a host</strong> with a public DNS address</li>
<li><strong>Pull down the project</strong> from the git repository. <code>git clone https://github.com/JasonLocklin/surveydown-container-server</code></li>
<li><strong>Edit a few configuration files</strong> to set your domain name and passwords.</li>
<li><strong>Run one command</strong> to start everything up. <code>docker-compose up -d</code></li>
</ol>
<aside class="notes">
<p>The goal of this project was to make self-hosting as straightforward as possible. You don’t need to be a systems administrator to get this running. You simply pull down the repository, edit a couple of text files, and run a single command. Docker Compose handles the rest, building and connecting all the containers automatically.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="lets-try-it" class="slide level2">
<h2>Lets try it</h2>
<p>Fill out the survey (it’s just for fun! data is public):</p>
<ul>
<li><a href="https://shiny.locklin.science/survey">https://shiny.locklin.science/survey</a></li>
</ul>
</section>
<section id="live-demo" class="slide level2">
<h2>Live Demo</h2>
<p>I have this setup running right now on a <strong>$5/month</strong> virtual private server from OVH in Montreal.</p>
<ul>
<li><strong>Standard Shiny Landing Page:</strong> <a href="https://shiny.locklin.science">https://shiny.locklin.science</a></li>
<li><strong>SurveyDown Templates:</strong> <a href="https://shiny.locklin.science/templates">https://shiny.locklin.science/templates</a></li>
<li><strong>Demo R Quiz for Today:</strong> <a href="https://shiny.locklin.science/survey">https://shiny.locklin.science/survey</a></li>
</ul>
<aside class="notes">
<p>To demonstrate how practical this is, I have a live demo running on a very low-cost, $5-per-month virtual server. You can visit these URLs right now. This entire setup, running multiple apps and a database, is handled by one of the cheapest servers you can rent.</p>
<p>Note that: the templates are individual applications and take a <em>long</em> time to start the first time they are opened on the server.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="the-future-potential" class="slide level2">
<h2>The Future Potential</h2>
<ul>
<li>A centralized, board-owned platform for all survey needs.</li>
<li>Empower researchers to create and collaborate on surveys.</li>
<li>Integrate survey data directly into your existing data warehouses and analytics workflows.</li>
<li>Build a community of practice around open-source tools in education.</li>
</ul>
<aside class="notes">
<p>So, what’s the big picture? I envision boards using their existing on-premise infrastructure to host a platform like this. It could become a centralized service for all departments. We can empower our colleagues to collect the data they need while ensuring that data remains secure and under our control, and we can build a community of practice around powerful, open-source tools like R, Quarto, and Docker.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="questions" class="slide level2">
<h2>Questions?</h2>
<p><strong>Thank You!</strong></p>
<ul>
<li><strong>Project Repo:</strong> <a href="https://github.com/JasonLocklin/surveydown-container-server">https://github.com/JasonLocklin/surveydown-container-server</a></li>
<li><strong>Surveydown</strong> <a href="https://surveydown.org/">https://surveydown.org/</a></li>
<li><strong>SurveyDown Templates:</strong> <a href="https://shiny.locklin.science/templates">https://shiny.locklin.science/templates</a></li>
<li><strong>Demo R Quiz for Today:</strong> <a href="https://shiny.locklin.science/survey">https://shiny.locklin.science/survey</a></li>
</ul>
<aside class="notes">
<p>That concludes my technical preview. I hope this has given you a sense of what’s possible with <code>surveydown</code> and a self-hosted approach. I’d be happy to answer any questions you have.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="errata-read-the-survey-data-with-r" class="title-slide slide level1 center">
<h1>Errata: Read the survey data with R</h1>
<p>The demo survey data can be read with:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a></a></span>
<span id="cb3-2"><a></a><span class="fu">library</span>(httr2)</span>
<span id="cb3-3"><a></a><span class="fu">library</span>(arrow)</span>
<span id="cb3-4"><a></a></span>
<span id="cb3-5"><a></a>resp <span class="ot">&lt;-</span> <span class="fu">request</span>(<span class="st">"https://shiny.locklin.science/data-export/responses_latest.parquet"</span>) <span class="sc">|&gt;</span></span>
<span id="cb3-6"><a></a>  <span class="fu">req_auth_basic</span>(<span class="st">"data"</span>, <span class="st">"defaultpassword"</span>) <span class="sc">|&gt;</span></span>
<span id="cb3-7"><a></a>  <span class="fu">req_perform</span>()</span>
<span id="cb3-8"><a></a></span>
<span id="cb3-9"><a></a>df <span class="ot">&lt;-</span> <span class="fu">read_parquet</span>(<span class="fu">rawConnection</span>(resp<span class="sc">$</span>body))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>


</section>
    </div>
  <div class="quarto-auto-generated-content" style="display: none;">
<p><img src="images/tcdsb-logo-placeholder.png" class="slide-logo"></p>
<div class="footer footer-default">
<p>SurveyDown Technical Preview</p>
</div>
</div></div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="site_libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="site_libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="site_libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="site_libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="site_libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="site_libs/revealjs/plugin/notes/notes.js"></script>
  <script src="site_libs/revealjs/plugin/search/search.js"></script>
  <script src="site_libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="site_libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'jumpToSlide': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleScrollView(event)\"><kbd>r</kbd> Scroll View Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const onCopySuccess = function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      }
      const getTextToCopy = function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
        text: getTextToCopy
      });
      clipboard.on('success', onCopySuccess);
      if (window.document.getElementById('quarto-embedded-source-code-modal')) {
        const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
          text: getTextToCopy,
          container: window.document.getElementById('quarto-embedded-source-code-modal')
        });
        clipboardModal.on('success', onCopySuccess);
      }
        var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
        var mailtoRegex = new RegExp(/^mailto:/);
          var filterRegex = new RegExp('/' + window.location.host + '/');
        var isInternal = (href) => {
            return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
        }
        // Inspect non-navigation links and adorn them if external
     	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
        for (var i=0; i<links.length; i++) {
          const link = links[i];
          if (!isInternal(link.href)) {
            // undo the damage that might have been done by quarto-nav.js in the case of
            // links that we want to consider external
            if (link.dataset.originalHref !== undefined) {
              link.href = link.dataset.originalHref;
            }
          }
        }
      function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
        const config = {
          allowHTML: true,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start',
        };
        if (contentFn) {
          config.content = contentFn;
        }
        if (onTriggerFn) {
          config.onTrigger = onTriggerFn;
        }
        if (onUntriggerFn) {
          config.onUntrigger = onUntriggerFn;
        }
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note) {
            return note.innerHTML;
          } else {
            return "";
          }
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>